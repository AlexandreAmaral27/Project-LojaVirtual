<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="images/logos/fav-icon/letra-a.png" type="image/x-icon">
    <title>A.roy_Store</title>
    <link rel="stylesheet" href="estilo/style-produto.css">
    <link rel="stylesheet" href="estilo/style.css">
    <link rel="stylesheet" href="estilo/menu.css">
    <link rel="stylesheet" href="estilo/mediaquerystyle.css">
    <link rel="stylesheet" href="estilo/mediaquerystyle-produto.css"> 

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!--FONT AWESOME -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script> 
    <!-- CHART.JS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

     <style>
       .mb-4 {
    width: 100%;
    margin-bottom: 1.5rem !important;
}
    .headerconteiner {
    display: flex;
    justify-content: space-between; /* logo à esquerda, menu no meio, hambúrguer/carrinho à direita */
    align-items: center;
    width: 100%;
    max-width: 1300px; /* se quiser alinhar como no resto */
    margin: 0 auto;
    padding: 0 1rem;
}

    .navbar{
         background-color: #2c2c2c;
    padding: 1rem;
    position: sticky;
    top: 0;
    z-index: 999;
    display: flex;
    justify-content: space-between;
    align-items: center;
    }    
nav {
    background-color: #2c2c2c;
    padding: 1rem;
    position: sticky;
    top: 0;
    z-index: 999;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
 
    </style>
    
</head>

<body>
    
   <div class="navbar show-menu">
    <div class="headerconteiner">
        <!-- Logo colada no início -->
        <a href="index.html"><img src="images/a.roy/logo.png" alt="Logo" class="logo"></a>
        
        <!-- Menu central -->
        <nav>
            <ul class="show menu" id="menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="produtos.html">Produtos</a></li>
                <li><a href="sobre.html">Sobre</a></li>
                <li><a href="contacto-nos.html">Contato</a></li>
                <li><a href="conta.html">Conta</a></li>
            </ul>
        </nav>

        <!-- Ícones carrinho + hambúrguer no fim -->
        <div class="navicon">
            <a href="produtos.html"><img src="images/logos/cart.png"></a>
            <div class="navicon2">
                <div class="hamburger" id="hamburger">
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>
    </div>
    <!-- HEADER (abaixo da navbar) -->
    
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Compras</h2>
            <div class="d-flex gap-2 align-items-center">
                <button onclick="mostrarHistorico()" class="btn btn-secondary">
                    <i class="fas fa-history"></i> Histórico
                </button>
                <button onclick="toggleCart()" class="btn btn-outline-primary">
                    <i class="fas fa-shopping-cart"></i> 🛒 
                    <span id="cart-count" class="badge bg-danger">0</span>
                </button>
            </div>
        </div>
  
</div>


            <!-- CARRINHO -->
        <div class="cart-container" id="cart-container">
            <h2>Seu Carrinho</h2>
            <ul id="cart-items" class="list-unstyled"></ul>
            <p class="total fw-bold" id="cart-total-line">Total: 0 Kzs</p>
            <button class="checkout-btn btn btn-primary mb-2" onclick="checkout()">Finalizar Compra</button>
            <button class="clear-btn btn btn-danger" onclick="limparCarrinho()">Limpar Carrinho</button>

             <a class="whatsapp-float" href="https://wa.me/244929764090?text=Olá%2C%20gostaria%20de%20fazer%20um%20pedido!" target="_blank"><button>Enviar Comprovativo</button></a> 
            <p class="mt-2 small text-muted"  id="session-timer"></p>
            <button onclick="toggleCart()" class="btn btn2 btn-secondary">Fechar</button>
        </div>

        <!-- HISTÓRICO -->
        <div class="cart-container" id="historico-container" style="display: none;">
            <h2>Histórico de Compras</h2>
            <ul id="historico-list" class="mb-3 "></ul>
            <!-- <canvas id="graficoHistorico" height="200"></canvas> -->
            <button onclick="fecharHistorico()" class="btn btn2 btn-secondary mt-3">Fechar</button>
        </div>


    <main>

        <!-- FILTRO -->
        <div class="filter-container">
            <label for="category">Filtrar por categoria:</label>
            <select id="category" onchange="filterProducts()">
                <option value="all">Todos</option>
                <option value="telefones">Telefones</option>
                <option value="computadores">Computadores</option>
                <option value="games">Games/Acessórios</option>
                <option value="acessorios">Tênis e outros Acessórios</option>
            </select>
        </div>

       <div class="produto-container" id="product-list">

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone x/preto.jpg" alt="Produto 1" width="260px">
                <p>iphone x</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone xs/branco.jpg" alt="Produto 1" width="260px">
                <p>iphone xs</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone xs max/dourado.png" alt="Produto 1" width="260px">
                <p>iphone xs Max</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 11/branco.webp" alt="Produto 1" width="260px">
                <p>iphone 11</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 11 pro/41chhux8krS.jpg" alt="Produto 1" width="260px">
                <p>iphone 11 pro </p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 11 pro max/branco.jpg" alt="Produto 1" width="260px">
                <p>iphone 11 pro max</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 12/lilas.webp" alt="Produto 1" width="260px">
                <p>iphone 12</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 12 pro/iphone-12-pro-max-434446.webp" alt="Produto 1" width="260px">
                <p>iphone 12 pro</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 12 pro max/41SLL9Zws6L._UF894,1000_QL80_.jpg" alt="Produto 1" width="260px">
                <p>iphone 12 pro max</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>




           <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 13/71MKNCEgE6L.jpg" alt="Produto 1" width="260px">
                <p>iphone 13</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 13 pro/iphone_13pro_im1.webp" alt="Produto 1" width="260px">
                <p>iphone 13 pro</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 13 pro max/azul.jpg" alt="Produto 1" width="260px">
                <p>iphone 13 pro max</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

        <a class="inf-produto" href="inside.html">
            
                 <div class="produto " data-category="telefones">
                    <img src="images/products/telephones/Iphones/iphone 14/vermelho.png" alt="Produto 1" width="260px">
                    <p>iphone 14</p>
                    <p class="preço">54.000<span>Kzs</span></p>
                    <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
                </div>
        </a>

             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 14 pro/preto.png" alt="Produto 1" width="260px">
                <p>iphone 14 pro </p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>

            <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 14 pro max/dourado.png" alt="Produto 1" width="260px">
                <p>iphone 14 pro max</p>
                <p class="preço">54.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>
             <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 15/rosa.png" alt="Produto 2" width="260px">
                <p>Iphone 15</p>
                <p class="preço">70.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Controle Xbox', 70000)">Adicionar</button> 
            </div>
            <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 15 pro/preto.png" alt="Produto 3" width="260px">
                <p>Iphone 15 pro</p>
                <p class="preço">150.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Carregador Rápido', 25000)">Adicionar</button> 
            </div>

            <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 15 pro max/natural.png" alt="Produto 3" width="260px">
                <p>Iphone 15 pro max</p>
                <p class="preço">150.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Carregador Rápido', 25000)">Adicionar</button> 
            </div>

            <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 16/preto.jpg" alt="Produto 3" width="260px">
                <p>Iphone 16</p>
                <p class="preço">150.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Carregador Rápido', 25000)">Adicionar</button> 
            </div>

            <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 16 plus/verde.webp" alt="Produto 3" width="260px">
                <p>Iphone 16 plus</p>
                <p class="preço">150.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Carregador Rápido', 25000)">Adicionar</button> 
            </div>

              <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 16 pro/deserto.webp" alt="Produto 3" width="260px">
                <p>Iphone 16 pro</p>
                <p class="preço">150.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Carregador Rápido', 25000)">Adicionar</button> 
            </div>

              <div class="produto" data-category="telefones">
                <img src="images/products/telephones/Iphones/iphone 16 pro max/natural.jpg" alt="Produto 3" width="260px">
                <p>Iphone 16 pro max</p>
                <p class="preço">150.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Carregador Rápido', 25000)">Adicionar</button> 
            </div>

          
          

            <div class="produto" data-category="telefones">
                <img src="images/products/telephones/samsung/product-9.png" alt="Produto 1" width="260px">
                <p>Samsung Galaxi S23 Ultra</p>
                <p class="preço">954.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Fone Bluetooth', 54000)">Adicionar</button> 
            </div>
            
           
            <div class="produto" data-category="games">
                <img src="images/products/games/x box/product-12.png" alt="Produto 4" width="260px">
                <p>Xbox</p>
                <p class="preço">600.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Smartwatch', 100000)">Adicionar</button> 
            </div>

            <div class="produto" data-category="games">
                <img src="images/products/games/play 5/product-14.png" alt="Produto 2" width="260px">
                <p>Play 5</p>
                <p class="preço">700.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Controle Xbox', 70000)">Adicionar</button> 
            </div>
            <div class="produto" data-category="computadores">
                <img src="images/products/games/pc-gamer/product-15.png" alt="Produto 3" width="260px">
                <p>PC Gamer</p>
                <p class="preço">900.000<span>Kzs</span></p>
                <button class="add-to-cart" onclick="addToCart('Carregador Rápido', 25000)">Adicionar</button> 
            </div>
           
            
        </div>
       
    </main>

    <footer class="gray-background">
        <div class="page-inner-content footer-content">
            <div class="download-options">
                <p>Baixe a nossa aplicação</p>
                <p>Disponível para Android e iOS</p>
                <div>
                    <img src="images/logos/app-store.png" alt="">
                    <img src="images/logos/play-store.png" alt="">
                </div>
            </div>
            <div class="logo-footer">
                <a href="index.html"><img src="images/a.roy/logo.png" alt="Logo" class="logo-footer1"></a>
                <p>O objetivo da nossa loja virtual é ser um ágil instrumento para compra e venda de produtos e serviços...</p>
            </div>
            <div class="links-footer">
                <h3>Links Úteis</h3>
                <ul>
                    <a href="#"><li>Cupons</li></a>
                    <a href="https://alexandreamaral27.github.io/project-Blog-Pessoal/index.html" target="_blank"><li>Blog Pessoal</li></a>
                    <a href="#"><li>Políticas</li></a>
                    <a href="#"><li>Torne-se Afiliado</li></a>
                </ul>
            </div>
        </div>
        <hr class="page-inner-content">
        <div class="page-inner-content copyright">
            <p>Copyright 2025 - Alexandre Amaral - Todos os direitos reservados</p>
        </div>
    </footer>

    <script>
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        let sessionTimeout;
        let sessionTimeLeft = 15 * 60;

        function showToast(msg) {
            const toast = document.createElement("div");
            toast.className = "toast";
            toast.innerText = msg;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function updateCart() {
            const cartItems = document.getElementById("cart-items");
            const cartCount = document.getElementById("cart-count");
            const cartTotalLine = document.getElementById("cart-total-line");
            cartItems.innerHTML = "";
            let total = 0, count = 0;

            cart.forEach((item, index) => {
                const li = document.createElement("li");
                li.innerHTML = `
                    ${item.name} - ${item.quantity} x ${item.price.toLocaleString()} Kzs =
                    <strong>${(item.quantity * item.price).toLocaleString()} Kzs</strong>
                    <button class="btn btn-sm btn-danger ms-2" onclick="removeFromCart(${index})">X</button>
                `;
                cartItems.appendChild(li);
                total += item.price * item.quantity;
                count += item.quantity;
            });

            cartCount.innerText = count;
            cartTotalLine.innerText = `Total: ${total.toLocaleString()} Kzs`;
            localStorage.setItem("cart", JSON.stringify(cart));
        }

        function addToCart(name, price) {
            const existing = cart.find(i => i.name === name);
            if (existing) {
                existing.quantity++;
            } else {
                cart.push({ name, price, quantity: 1 });
            }
            updateCart();
            showToast(`${name} adicionado ao carrinho`);
            resetSessionTimer();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCart();
            resetSessionTimer();
        }

        function limparCarrinho() {
            if (confirm("Deseja limpar o carrinho?")) {
                cart = [];
                updateCart();
                localStorage.removeItem("cart");
                showToast("Carrinho limpo");
            }
        }

        function checkout() {
            if (cart.length === 0) return alert("Seu carrinho está vazio!");
            let total = 0, resumo = "Compra finalizada:\n";
            cart.forEach(item => {
                resumo += `${item.quantity}x ${item.name} = ${(item.quantity * item.price).toLocaleString()} Kzs\n`;
                total += item.quantity * item.price;
            });
            resumo += `Total: ${total.toLocaleString()} Kzs`;
            alert(resumo);

            const historico = JSON.parse(localStorage.getItem("historicoCompras")) || [];
            historico.push({
                data: new Date().toLocaleString(),
                itens: [...cart],
                total: total
            });
            localStorage.setItem("historicoCompras", JSON.stringify(historico));

            limparCarrinho();
            toggleCart();
        }

        function toggleCart() {
            document.getElementById("cart-container").classList.toggle("show");
            resetSessionTimer();
        }

        function resetSessionTimer() {
            clearInterval(sessionTimeout);
            sessionTimeLeft = 15 * 60;
            updateTimer();
            sessionTimeout = setInterval(() => {
                sessionTimeLeft--;
                updateTimer();
                if (sessionTimeLeft <= 0) {
                    clearInterval(sessionTimeout);
                    cart = [];
                    updateCart();
                    localStorage.removeItem("cart");
                    document.getElementById("cart-container").classList.remove("show");
                    showToast("Sessão expirada! Carrinho limpo.");
                }
            }, 1000);
        }

        function updateTimer() {
            const min = Math.floor(sessionTimeLeft / 60);
            const sec = sessionTimeLeft % 60;
            document.getElementById("session-timer").innerText = `Sessão expira em: ${min}m ${sec}s`;
        }

        function mostrarHistorico() {
            const historico = JSON.parse(localStorage.getItem("historicoCompras")) || [];
            const list = document.getElementById("historico-list");
            list.innerHTML = "";

            if (historico.length === 0) {
                list.innerHTML = "<li>Nenhuma compra encontrada.</li>";
            } else {
                historico.forEach((compra, i) => {
                    const li = document.createElement("li");
                    li.innerHTML = `<strong>Compra #${i + 1}</strong><br>${compra.data}<br>${compra.itens.map(i => `${i.quantity}x ${i.name}`).join(", ")}<br><strong>Total:</strong> ${compra.total.toLocaleString()} Kzs`;
                    list.appendChild(li);
                });
            }

            document.getElementById("historico-container").style.display = "block";
            desenharGraficoHistorico(historico);
        }

        function fecharHistorico() {
            document.getElementById("historico-container").style.display = "none";
        }

        function desenharGraficoHistorico(historico) {
            const ctx = document.getElementById("graficoHistorico").getContext("2d");
            const labels = historico.map((c, i) => `#${i + 1}`);
            const valores = historico.map(c => c.total);

            new Chart(ctx, {
                type: "bar",
                data: {
                    labels,
                    datasets: [{
                        label: "Total por Compra (Kzs)",
                        data: valores,
                        backgroundColor: "#007bff"
                    }]
                },
                options: { responsive: true, scales: { y: { beginAtZero: true } } }
            });
        }

        function filterProducts() {
            const category = document.getElementById("category").value;
            const products = document.querySelectorAll(".produto");
            products.forEach(product => {
                product.style.display = (category === "all" || product.getAttribute("data-category") === category)
                    ? "block"
                    : "none";
            });
        }

        document.getElementById("hamburger").addEventListener("click", () => {
            document.getElementById("hamburger").classList.toggle("active");
            document.getElementById("menu").classList.toggle("show");
        });

        updateCart();
        if (cart.length > 0) resetSessionTimer();
    </script>
</body>
</html>
